---
layout: advisory
title: 'CVE-2013-6417: Incomplete fix to CVE-2013-0155 (Unsafe Query Generation Risk)'
comments: false
categories:
- actionpack
- rails
advisory:
  gem: actionpack
  framework: rails
  cve: 2013-6417
  osvdb: 100527
  url: https://groups.google.com/forum/#!topic/ruby-security-ann/niK4drpSHT4
  title: Incomplete fix to CVE-2013-0155 (Unsafe Query Generation Risk)
  date: 2013-12-03
  description: "The prior fix to CVE-2013-0155 was incomplete and the use of common\n3rd
    party libraries can accidentally circumvent the protection. Due\nto the way that
    Rack::Request and Rails::Request interact, it is\npossible for a 3rd party or
    custom rack middleware to parse the\nparameters insecurely and store them in the
    same key that Rails uses\nfor its own parameters.  In the event that happens the
    application\nwill receive unsafe parameters and could be vulnerable to the earlier\nvulnerability.
    \n"
  cvss_v2: 
  patched_versions:
  - ~> 3.2.16
  - '>= 4.0.2'
---
